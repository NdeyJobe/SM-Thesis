"0","# Load necessary libraries"
"0","library(gt)"
"2","Warning: package ‘gt’ was built under R version 4.4.1"
"0","library(dplyr)"
"2","
Attaching package: ‘dplyr’

"
"2","The following objects are masked from ‘package:stats’:

    filter, lag

"
"2","The following objects are masked from ‘package:base’:

    intersect, setdiff, setequal, union

"
"0","# Define the hierarchical structure with exactly 12 rows for ""CKD Very High Risk"""
"0","Risk_Group <- c(""CKD Very High Risk"", rep("""", 11))"
"0","Race <- rep(c(""  All Races"", """", """", ""  Black"", """", """", ""  White"", """", """", ""  Asian"", """", """"), times = 1)"
"0","Model <- rep(c(""    MDRD"", ""    CKD-EPI-2009"", ""    CKD-EPI-2021""), times = 4)"
"0",""
"0","# Define example C_Statistic, CI_Lower, and CI_Upper values for 2-year and 5-year predictions including ""All Races"" as reference"
"0","C_Statistic_2yr <- c("
"0","  #### VERY HIGH RISK"
"0","  # CKD Very High Risk - All Races"
"0","  0.78, # All Races - MDRD - 2-year"
"0","  0.81, # All Races - CKD-EPI-2009 - 2-year"
"0","  0.80, # All Races - CKD-EPI-2021 - 2-year"
"0","  "
"0","  # CKD Very High Risk - Black or African American"
"0","  0.70, # Black - MDRD - 2-year"
"0","  0.74, # Black - CKD-EPI-2009 - 2-year"
"0","  0.80, # Black - CKD-EPI-2021 - 2-year"
"0","  "
"0","  # CKD Very High Risk - White"
"0","  0.79, # White - MDRD - 2-year"
"0","  0.82, # White - CKD-EPI-2009 - 2-year"
"0","  0.78, # White - CKD-EPI-2021 - 2-year"
"0","  "
"0","  # CKD Very High Risk - Asian"
"0","  0.82, # Asian - MDRD - 2-year"
"0","  0.82, # Asian - CKD-EPI-2009 - 2-year"
"0","  0.79)  # Asian - CKD-EPI-2021 - 2-year"
"0",""
"0","CI_Lower_2yr <- c("
"0","  # very high risk"
"0","  0.76, # All Races - MDRD - 2-year CI Lower"
"0","  0.79, # All Races - CKD-EPI-2009 - 2-year CI Lower"
"0","  0.77, # All Races - CKD-EPI-2021 - 2-year CI Lower"
"0","  "
"0","  0.65, # Black - MDRD - 2-year CI Lower"
"0","  0.70, # Black - CKD-EPI-2009 - 2-year CI Lower"
"0","  0.76, # Black - CKD-EPI-2021 - 2-year CI Lower"
"0","  "
"0","  0.76, # White - MDRD - 2-year CI Lower"
"0","  0.79, # White - CKD-EPI-2009 - 2-year CI Lower"
"0","  0.75, # White - CKD-EPI-2021 - 2-year CI Lower"
"0","  "
"0","  0.72, # Asian - MDRD - 2-year CI Lower"
"0","  0.71, # Asian - CKD-EPI-2009 - 2-year CI Lower"
"0","  0.65)  # Asian - CKD-EPI-2021 - 2-year CI Lower"
"0","  "
"0","CI_Upper_2yr <- c("
"0","  # very high risk"
"0","  0.80, # All Races - MDRD - 2-year CI Upper"
"0","  0.83, # All Races - CKD-EPI-2009 - 2-year CI Upper"
"0","  0.81, # All Races - CKD-EPI-2021 - 2-year CI Upper"
"0","  "
"0","  0.75, # Black - MDRD - 2-year CI Upper"
"0","  0.78, # Black - CKD-EPI-2009 - 2-year CI Upper"
"0","  0.83, # Black - CKD-EPI-2021 - 2-year CI Upper"
"0","  "
"0","  0.83, # White - MDRD - 2-year CI Upper"
"0","  0.85, # White - CKD-EPI-2009 - 2-year CI Upper"
"0","  0.82, # White - CKD-EPI-2021 - 2-year CI Upper"
"0","  "
"0","  0.92, # Asian - MDRD - 2-year CI Upper"
"0","  0.91, # Asian - CKD-EPI-2009 - 2-year CI Upper"
"0","  0.89)  # Asian - CKD-EPI-2021 - 2-year CI Upper"
"0","  "
"0",""
"0","C_Statistic_5yr <- c("
"0","  # CKD Very High Risk - All Races"
"0","  0.77, # All Races - MDRD - 5-year"
"0","  0.80, # All Races - CKD-EPI-2009 - 5-year"
"0","  0.78, # All Races - CKD-EPI-2021 - 5-year"
"0","  "
"0","  # CKD Very High Risk - Black or African American"
"0","  0.69, # Black - MDRD - 5-year"
"0","  0.73, # Black - CKD-EPI-2009 - 5-year"
"0","  0.77, # Black - CKD-EPI-2021 - 5-year"
"0","  "
"0","  # CKD Very High Risk - White"
"0","  0.78, # White - MDRD - 5-year"
"0","  0.81, # White - CKD-EPI-2009 - 5-year"
"0","  0.77, # White - CKD-EPI-2021 - 5-year"
"0","  "
"0","  # CKD Very High Risk - Asian"
"0","  0.82, # Asian - MDRD - 5-year"
"0","  0.82, # Asian - CKD-EPI-2009 - 5-year"
"0","  0.79)  # Asian - CKD-EPI-2021 - 5-year"
"0","  "
"0","CI_Lower_5yr <- c("
"0","  0.75, # All Races - MDRD - 5-year CI Lower"
"0","  0.78, # All Races - CKD-EPI-2009 - 5-year CI Lower"
"0","  0.76, # All Races - CKD-EPI-2021 - 5-year CI Lower"
"0","  "
"0","  0.65, # Black - MDRD - 5-year CI Lower"
"0","  0.69, # Black - CKD-EPI-2009 - 5-year CI Lower"
"0","  0.74, # Black - CKD-EPI-2021 - 5-year CI Lower"
"0","  "
"0","  0.74, # White - MDRD - 5-year CI Lower"
"0","  0.78, # White - CKD-EPI-2009 - 5-year CI Lower"
"0","  0.74, # White - CKD-EPI-2021 - 5-year CI Lower"
"0","  "
"0","  0.70, # Asian - MDRD - 5-year CI Lower"
"0","  0.70, # Asian - CKD-EPI-2009 - 5-year CI Lower"
"0","  0.65)  # Asian - CKD-EPI-2021 - 5-year CI Lower"
"0","  "
"0","CI_Upper_5yr <- c("
"0","  0.79, # All Races - MDRD - 5-year CI Upper"
"0","  0.82, # All Races - CKD-EPI-2009 - 5-year CI Upper"
"0","  0.80, # All Races - CKD-EPI-2021 - 5-year CI Upper"
"0","  "
"0","  0.73, # Black - MDRD - 5-year CI Upper"
"0","  0.76, # Black - CKD-EPI-2009 - 5-year CI Upper"
"0","  0.80, # Black - CKD-EPI-2021 - 5-year CI Upper"
"0","  "
"0","  0.81, # White - MDRD - 5-year CI Upper"
"0","  0.84, # White - CKD-EPI-2009 - 5-year CI Upper"
"0","  0.80, # White - CKD-EPI-2021 - 5-year CI Upper"
"0","  "
"0","  0.92, # Asian - MDRD - 5-year CI Upper"
"0","  0.92, # Asian - CKD-EPI-2009 - 5-year CI Upper"
"0","  0.90)  # Asian - CKD-EPI-2021 - 5-year CI Upper"
"0",""
"0","# Combine data for 2-year and 5-year predictions, filtering only for ""CKD Very High Risk"""
"0","data_2yr <- data.frame("
"0","  Risk_Group = Risk_Group,"
"0","  Race = Race,"
"0","  Model = Model,"
"0","  C_Statistic = C_Statistic_2yr,"
"0","  CI_Lower = CI_Lower_2yr,"
"0","  CI_Upper = CI_Upper_2yr"
"0",") %>% filter(Risk_Group == ""CKD Very High Risk"" | Risk_Group == """")"
"0",""
"0","data_5yr <- data.frame("
"0","  Risk_Group = Risk_Group,"
"0","  Race = Race,"
"0","  Model = Model,"
"0","  C_Statistic = C_Statistic_5yr,"
"0","  CI_Lower = CI_Lower_5yr,"
"0","  CI_Upper = CI_Upper_5yr"
"0",") %>% filter(Risk_Group == ""CKD Very High Risk"" | Risk_Group == """")"
"0",""
"0","# Function to create gt table without the Prediction_Period column"
"0","create_gt_table <- function(data, title) {"
"0","  data %>%"
"0","    mutate("
"0","      CI_Label = sprintf(""%.2f (%.2f–%.2f)"", C_Statistic, CI_Lower, CI_Upper),"
"0","      Error_Bar = paste0(""⎯"", strrep(""⎯"", round((C_Statistic - CI_Lower) / 0.01)), ""●"", strrep(""⎯"", round((CI_Upper - C_Statistic) / 0.01)), ""⎯"")"
"0","    ) %>%"
"0","    gt() %>%"
"0","    cols_hide(columns = c(C_Statistic, CI_Lower, CI_Upper)) %>%"
"0","    tab_header("
"0","      title = md(paste0(""**Hierarchical Forest Plot Table - "", title, ""**""))"
"0","    ) %>%"
"0","    cols_label("
"0","      Risk_Group = md(""**Cohort / Population**""),"
"0","      Model = md(""**Prediction Model**""),"
"0","      CI_Label = md(""**C Statistic (95% CI)**""),"
"0","      Error_Bar = md(""**Error Bar with Point Estimate**"")"
"0","    ) %>%"
"0","    fmt_markdown(columns = c(Risk_Group, Race, Model)) %>%"
"0","    tab_style("
"0","      style = cell_text(weight = ""bold"", size = px(14)), # Bold and larger for Risk Group"
"0","      locations = cells_body(columns = ""Risk_Group"", rows = data$Risk_Group == ""CKD Very High Risk"")"
"0","    ) %>%"
"0","    tab_style("
"0","      style = cell_text(indent = px(20), weight = ""bold"", size = px(12)), # Bold and larger for Race"
"0","      locations = cells_body(columns = ""Race"")"
"0","    ) %>%"
"0","    tab_style("
"0","      style = cell_text(indent = px(40), weight = ""bold"", size = px(12)), # Bold and larger for Model"
"0","      locations = cells_body(columns = ""Model"")"
"0","    ) %>%"
"0","    cols_align(align = ""center"", columns = c(""CI_Label"", ""Error_Bar"")) %>%"
"0","    tab_options("
"0","      table.font.size = px(14), # Increase overall font size"
"0","      data_row.padding = px(8), # Add more padding to rows for better readability"
"0","      heading.title.font.size = px(18), # Larger title font size"
"0","      column_labels.font.size = px(16)  # Larger column label font size"
"0","    ) %>%"
"0","    tab_style("
"0","      style = cell_text(color = ""blue"", weight = ""bold"", size = px(12)), # Larger and bold for MDRD error bar"
"0","      locations = cells_body(columns = ""Error_Bar"", rows = data$Model == ""    MDRD"")"
"0","    ) %>%"
"0","    tab_style("
"0","      style = cell_text(color = ""green"", weight = ""bold"", size = px(12)), # Larger and bold for CKD-EPI-2009 error bar"
"0","      locations = cells_body(columns = ""Error_Bar"", rows = data$Model == ""    CKD-EPI-2009"")"
"0","    ) %>%"
"0","    tab_style("
"0","      style = cell_text(color = ""red"", weight = ""bold"", size = px(12)), # Larger and bold for CKD-EPI-2021 error bar"
"0","      locations = cells_body(columns = ""Error_Bar"", rows = data$Model == ""    CKD-EPI-2021"")"
"0","    )"
"0","}"
"0",""
"0","# Create tables for both 2-year and 5-year predictions"
"0","table_2yr <- create_gt_table(data_2yr, title = ""2-year Prediction"")"
"0","table_5yr <- create_gt_table(data_5yr, title = ""5-year Prediction"")"
"0",""
"0","# Display the tables"
"0","table_2yr"
