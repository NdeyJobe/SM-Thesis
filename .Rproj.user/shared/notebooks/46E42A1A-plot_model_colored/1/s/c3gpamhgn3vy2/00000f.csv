"0","data_all_races_2yr <- data.frame("
"0","  Model = rep(c(""MDRD"", ""CKD-EPI-2009"", ""CKD-EPI-2021""), each = 5),"
"0","  Population = c(""CKD Very High Risk"", ""CKD High Risk"", ""CKD Medium Risk"", ""Diabetic"", ""Hypertensive"","
"0","                 ""CKD Very High Risk"", ""CKD High Risk"", ""CKD Medium Risk"", ""Diabetic"", ""Hypertensive"","
"0","                 ""CKD Very High Risk"", ""CKD High Risk"", ""CKD Medium Risk"", ""Diabetic"", ""Hypertensive""),"
"0","  C_Statistic = c("
"0","    0.779686, # MDRD - CKD Very High Risk"
"0","    0.805643, # MDRD - CKD High Risk"
"0","    0.709639, # MDRD - CKD Medium Risk"
"0","    0.899632, # MDRD - Diabetic"
"0","    0.942987, # MDRD - Hypertensive"
"0","    0.813301, # CKD-EPI-2009 - CKD Very High Risk"
"0","    0.844476, # CKD-EPI-2009 - CKD High Risk"
"0","    0.720784, # CKD-EPI-2009 - CKD Medium Risk"
"0","    0.891147, # CKD-EPI-2009 - Diabetic"
"0","    0.939097, # CKD-EPI-2009 - Hypertensive"
"0","    0.796280, # CKD-EPI-2021 - CKD Very High Risk"
"0","    0.852609, # CKD-EPI-2021 - CKD High Risk"
"0","    0.725854, # CKD-EPI-2021 - CKD Medium Risk"
"0","    0.897064, # CKD-EPI-2021 - Diabetic"
"0","    0.945428  # CKD-EPI-2021 - Hypertensive"
"0","  ),"
"0","  CI_Lower = c("
"0","    0.755165, # MDRD - CKD Very High Risk"
"0","    0.721847, # MDRD - CKD High Risk"
"0","    0.636664, # MDRD - CKD Medium Risk"
"0","    0.704232, # MDRD - Diabetic"
"0","    0.890367, # MDRD - Hypertensive"
"0","    0.794048, # CKD-EPI-2009 - CKD Very High Risk"
"0","    0.776855, # CKD-EPI-2009 - CKD High Risk"
"0","    0.638932, # CKD-EPI-2009 - CKD Medium Risk"
"0","    0.681531, # CKD-EPI-2009 - Diabetic"
"0","    0.886220, # CKD-EPI-2009 - Hypertensive"
"0","    0.772042, # CKD-EPI-2021 - CKD Very High Risk"
"0","    0.780654, # CKD-EPI-2021 - CKD High Risk"
"0","    0.650448, # CKD-EPI-2021 - CKD Medium Risk"
"0","    0.695565, # CKD-EPI-2021 - Diabetic"
"0","    0.893176  # CKD-EPI-2021 - Hypertensive"
"0","  ),"
"0","  CI_Upper = c("
"0","    0.802493, # MDRD - CKD Very High Risk"
"0","    0.880765, # MDRD - CKD High Risk"
"0","    0.786525, # MDRD - CKD Medium Risk"
"0","    0.929299, # MDRD - Diabetic"
"0","    0.983280, # MDRD - Hypertensive"
"0","    0.834802, # CKD-EPI-2009 - CKD Very High Risk"
"0","    0.903122, # CKD-EPI-2009 - CKD High Risk"
"0","    0.791094, # CKD-EPI-2009 - CKD Medium Risk"
"0","    0.991850, # CKD-EPI-2009 - Diabetic"
"0","    0.981115, # CKD-EPI-2009 - Hypertensive"
"0","    0.818550, # CKD-EPI-2021 - CKD Very High Risk"
"0","    0.914188, # CKD-EPI-2021 - CKD High Risk"
"0","    0.797735, # CKD-EPI-2021 - CKD Medium Risk"
"0","    0.993049, # CKD-EPI-2021 - Diabetic"
"0","    0.983250  # CKD-EPI-2021 - Hypertensive"
"0","  )"
"0",")"
"0",""
"0","data_all_races_5yr <- data.frame("
"0","  Model = rep(c(""MDRD"", ""CKD-EPI-2009"", ""CKD-EPI-2021""), each = 5),"
"0","  Population = c(""CKD Very High Risk"", ""CKD High Risk"", ""CKD Medium Risk"", ""Diabetic"", ""Hypertensive"","
"0","                 ""CKD Very High Risk"", ""CKD High Risk"", ""CKD Medium Risk"", ""Diabetic"", ""Hypertensive"","
"0","                 ""CKD Very High Risk"", ""CKD High Risk"", ""CKD Medium Risk"", ""Diabetic"", ""Hypertensive""),"
"0","  C_Statistic = c("
"0","    0.768199, # MDRD - CKD Very High Risk"
"0","    0.838233, # MDRD - CKD High Risk"
"0","    0.685313, # MDRD - CKD Medium Risk"
"0","    0.808021, # MDRD - Diabetic"
"0","    0.875976, # MDRD - Hypertensive"
"0","    0.800652, # CKD-EPI-2009 - CKD Very High Risk"
"0","    0.849406, # CKD-EPI-2009 - CKD High Risk"
"0","    0.702407, # CKD-EPI-2009 - CKD Medium Risk"
"0","    0.873060, # CKD-EPI-2009 - Diabetic"
"0","    0.872798, # CKD-EPI-2009 - Hypertensive"
"0","    0.780024, # CKD-EPI-2021 - CKD Very High Risk"
"0","    0.841732, # CKD-EPI-2021 - CKD High Risk"
"0","    0.709508, # CKD-EPI-2021 - CKD Medium Risk"
"0","    0.886446, # CKD-EPI-2021 - Diabetic"
"0","    0.886314  # CKD-EPI-2021 - Hypertensive"
"0","  ),"
"0","  CI_Lower = c("
"0","    0.745514, # MDRD - CKD Very High Risk"
"0","    0.789057, # MDRD - CKD High Risk"
"0","    0.636895, # MDRD - CKD Medium Risk"
"0","    0.762657, # MDRD - Diabetic"
"0","    0.824808, # MDRD - Hypertensive"
"0","    0.778143, # CKD-EPI-2009 - CKD Very High Risk"
"0","    0.806559, # CKD-EPI-2009 - CKD High Risk"
"0","    0.652600, # CKD-EPI-2009 - CKD Medium Risk"
"0","    0.739571, # CKD-EPI-2009 - Diabetic"
"0","    0.819850, # CKD-EPI-2009 - Hypertensive"
"0","    0.756730, # CKD-EPI-2021 - CKD Very High Risk"
"0","    0.793558, # CKD-EPI-2021 - CKD High Risk"
"0","    0.664284, # CKD-EPI-2021 - CKD Medium Risk"
"0","    0.763909, # CKD-EPI-2021 - Diabetic"
"0","    0.836951  # CKD-EPI-2021 - Hypertensive"
"0","  ),"
"0","  CI_Upper = c("
"0","    0.791358, # MDRD - CKD Very High Risk"
"0","    0.882210, # MDRD - CKD High Risk"
"0","    0.736944, # MDRD - CKD Medium Risk"
"0","    0.967884, # MDRD - Diabetic"
"0","    0.921812, # MDRD - Hypertensive"
"0","    0.822496, # CKD-EPI-2009 - CKD Very High Risk"
"0","    0.890232, # CKD-EPI-2009 - CKD High Risk"
"0","    0.749142, # CKD-EPI-2009 - CKD Medium Risk"
"0","    0.968422, # CKD-EPI-2009 - Diabetic"
"0","    0.928060, # CKD-EPI-2009 - Hypertensive"
"0","    0.807821, # CKD-EPI-2021 - CKD Very High Risk"
"0","    0.883747, # CKD-EPI-2021 - CKD High Risk"
"0","    0.757133, # CKD-EPI-2021 - CKD Medium Risk"
"0","    0.971421, # CKD-EPI-2021 - Diabetic"
"0","    0.928657  # CKD-EPI-2021 - Hypertensive"
"0","  )"
"0",")"
"0","    "
"0","    "
"0","    "
"0","# Load necessary libraries"
"0","library(dplyr)"
"0","library(gt)"
"0","library(magick)"
"0","library(webshot2)  # Required to capture HTML as an image"
"0","library(tidyr)     # Needed for replace_na function"
"0",""
"0","# Add formatted columns for display, excluding error bar"
"0","data_all_races_2yr <- data_all_races_2yr %>%"
"0","  mutate("
"0","    CI_Label = sprintf(""%.2f (%.2f–%.2f)"", C_Statistic, CI_Lower, CI_Upper)"
"0","  )"
"0",""
"0","data_all_races_5yr <- data_all_races_5yr %>%"
"0","  mutate("
"0","    CI_Label = sprintf(""%.2f (%.2f–%.2f)"", C_Statistic, CI_Lower, CI_Upper)"
"0","  )"
"0",""
"0","# Remove repeated ""Model"" column values except for the first instance in each group"
"0","data_all_races_clean_2yr <- data_all_races_2yr %>%"
"0","  group_by(Model) %>%"
"0","  mutate(Model = ifelse(row_number() == 0, Model, """")) %>%"
"0","  ungroup()"
"0",""
"0","data_all_races_clean_5yr <- data_all_races_5yr %>%"
"0","  group_by(Model) %>%"
"0","  mutate(Model = ifelse(row_number() == 0, Model, """")) %>%"
"0","  ungroup()"
"0",""
"0","# Function to generate gt table with enhanced font size and bold text"
"0","generate_gt_table <- function(data, title) {"
"0","  data %>%"
"0","    group_by(Model) %>%"
"0","    mutate(Model = ifelse(row_number() == 1, Model, """")) %>%"
"0","    ungroup() %>%"
"0","    select(-C_Statistic, -CI_Lower, -CI_Upper) %>%  # Exclude numeric columns not needed in display"
"0","    gt() %>%"
"0","    tab_header(title = md(paste0(""**Predictive Accuracy for All Populations - "", title, ""**""))) %>%"
"0","    cols_label("
"0","      Population = md(""**Cohort / Population**""),"
"0","      Model = md(""**Prediction Model**""),"
"0","      CI_Label = md(""**C Statistic (95% CI)**"")"
"0","    ) %>%"
"0","    tab_row_group(label = md(""**CKD-EPI-2021**""), rows = 11:15) %>%"
"0","    tab_row_group(label = md(""**CKD-EPI-2009**""), rows = 6:10) %>%"
"0","    tab_row_group(label = md(""**MDRD**""), rows = 1:5) %>%"
"0","    fmt_markdown(columns = c(Population, Model, CI_Label)) %>%  # Apply bold markdown styling to data cells"
"0","    tab_options("
"0","      table.font.size = px(40),"
"0","      data_row.padding = px(12),"
"0","      heading.title.font.size = px(50),"
"0","      heading.title.font.weight = ""bold"","
"0","      column_labels.font.size = px(50),"
"0","      column_labels.font.weight = ""bold"""
"0","    )"
"0","}"
"0",""
"0","# Generate the tables for 2-year and 5-year predictions"
"0","table_2yr <- generate_gt_table(data_all_races_clean_2yr, ""2-Year Prediction"")"
"0","table_5yr <- generate_gt_table(data_all_races_clean_5yr, ""5-Year Prediction"")"
"0",""
"0","# Create HTML files for the gt tables"
"0","gtsave(table_2yr, ""table_2yr.html"")"
"0","gtsave(table_5yr, ""table_5yr.html"")"
"0",""
"0","# Use webshot2 to save HTML as PNG"
"0","webshot(""table_2yr.html"", file = ""table_2yr.png"")"
"2","file:////Users/ndeyisatoujobe/Desktop/SM Thesis/table_2yr.html screenshot completed
"
"0","webshot(""table_5yr.html"", file = ""table_5yr.png"")"
"2","file:////Users/ndeyisatoujobe/Desktop/SM Thesis/table_5yr.html screenshot completed
"
"0","# Read the images and stack them vertically"
"0","img_2yr <- image_read(""table_2yr.png"")"
"0","img_5yr <- image_read(""table_5yr.png"")"
"0","combined_img <- image_append(c(img_2yr, img_5yr), stack = TRUE)"
"0",""
"0","# Save the combined image"
"0","image_write(combined_img, ""all_combined_prediction_tables.png"")"
"0",""
