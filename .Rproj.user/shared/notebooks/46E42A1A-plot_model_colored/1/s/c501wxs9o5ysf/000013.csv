"0","data_asian_2yr <- data.frame("
"0","  Model = rep(c(""MDRD"", ""CKD-EPI-2009"", ""CKD-EPI-2021""), each = 5),"
"0","  Population = c(""CKD Very High Risk"", ""CKD High Risk"", ""CKD Medium Risk"", ""Diabetic"", ""Hypertensive"","
"0","                 ""CKD Very High Risk"", ""CKD High Risk"", ""CKD Medium Risk"", ""Diabetic"", ""Hypertensive"","
"0","                 ""CKD Very High Risk"", ""CKD High Risk"", ""CKD Medium Risk"", ""Diabetic"", ""Hypertensive""),"
"0","  C_Statistic = c("
"0","    0.824268, # MDRD - CKD Very High Risk"
"0","    0.672556, # MDRD - CKD High Risk"
"0","    0.901895, # MDRD - CKD Medium Risk"
"0","    NA,       # MDRD - Diabetic"
"0","    1.000000, # MDRD - Hypertensive"
"0","    0.817991, # CKD-EPI-2009 - CKD Very High Risk"
"0","    0.649123, # CKD-EPI-2009 - CKD High Risk"
"0","    0.873491, # CKD-EPI-2009 - CKD Medium Risk"
"0","    NA,       # CKD-EPI-2009 - Diabetic"
"0","    1.000000, # CKD-EPI-2009 - Hypertensive"
"0","    0.792363, # CKD-EPI-2021 - CKD Very High Risk"
"0","    0.792363, # CKD-EPI-2021 - CKD High Risk"
"0","    0.877245, # CKD-EPI-2021 - CKD Medium Risk"
"0","    NA,       # CKD-EPI-2021 - Diabetic"
"0","    1.000000  # CKD-EPI-2021 - Hypertensive"
"0","  ),"
"0","  CI_Lower = c("
"0","    0.716796, # MDRD - CKD Very High Risk"
"0","    0.470177, # MDRD - CKD High Risk"
"0","    0.800953, # MDRD - CKD Medium Risk"
"0","    NA,       # MDRD - Diabetic"
"0","    1.000000, # MDRD - Hypertensive"
"0","    0.708241, # CKD-EPI-2009 - CKD Very High Risk"
"0","    0.471057, # CKD-EPI-2009 - CKD High Risk"
"0","    0.210791, # CKD-EPI-2009 - CKD Medium Risk"
"0","    NA,       # CKD-EPI-2009 - Diabetic"
"0","    1.000000, # CKD-EPI-2009 - Hypertensive"
"0","    0.665732, # CKD-EPI-2021 - CKD Very High Risk"
"0","    0.438168, # CKD-EPI-2021 - CKD High Risk"
"0","    0.182623, # CKD-EPI-2021 - CKD Medium Risk"
"0","    NA,       # CKD-EPI-2021 - Diabetic"
"0","    1.000000  # CKD-EPI-2021 - Hypertensive"
"0","  ),"
"0","  CI_Upper = c("
"0","    0.920117, # MDRD - CKD Very High Risk"
"0","    1.000000, # MDRD - CKD High Risk"
"0","    0.986492, # MDRD - CKD Medium Risk"
"0","    NA,       # MDRD - Diabetic"
"0","    1.000000, # MDRD - Hypertensive"
"0","    0.909698, # CKD-EPI-2009 - CKD Very High Risk"
"0","    1.000000, # CKD-EPI-2009 - CKD High Risk"
"0","    0.974717, # CKD-EPI-2009 - CKD Medium Risk"
"0","    NA,       # CKD-EPI-2009 - Diabetic"
"0","    1.000000, # CKD-EPI-2009 - Hypertensive"
"0","    0.909877, # CKD-EPI-2021 - CKD Very High Risk"
"0","    1.000000, # CKD-EPI-2021 - CKD High Risk"
"0","    0.975605, # CKD-EPI-2021 - CKD Medium Risk"
"0","    NA,       # CKD-EPI-2021 - Diabetic"
"0","    1.000000  # CKD-EPI-2021 - Hypertensive"
"0","  )"
"0",")"
"0",""
"0",""
"0","data_asian_5yr <- data.frame("
"0","  Model = rep(c(""MDRD"", ""CKD-EPI-2009"", ""CKD-EPI-2021""), each = 5),"
"0","  Population = c(""CKD Very High Risk"", ""CKD High Risk"", ""CKD Medium Risk"", ""Diabetic"", ""Hypertensive"","
"0","                 ""CKD Very High Risk"", ""CKD High Risk"", ""CKD Medium Risk"", ""Diabetic"", ""Hypertensive"","
"0","                 ""CKD Very High Risk"", ""CKD High Risk"", ""CKD Medium Risk"", ""Diabetic"", ""Hypertensive""),"
"0","  C_Statistic = c("
"0","    0.823409, # MDRD - CKD Very High Risk"
"0","    0.735294, # MDRD - CKD High Risk"
"0","    0.798039, # MDRD - CKD Medium Risk"
"0","    NA,       # MDRD - Diabetic"
"0","    0.746914, # MDRD - Hypertensive"
"0","    0.817249, # CKD-EPI-2009 - CKD Very High Risk"
"0","    0.727811, # CKD-EPI-2009 - CKD High Risk"
"0","    0.784967, # CKD-EPI-2009 - CKD Medium Risk"
"0","    NA,       # CKD-EPI-2009 - Diabetic"
"0","    0.737654, # CKD-EPI-2009 - Hypertensive"
"0","    0.791691, # CKD-EPI-2021 - CKD Very High Risk"
"0","    0.791691, # CKD-EPI-2021 - CKD High Risk"
"0","    0.789270, # CKD-EPI-2021 - CKD Medium Risk"
"0","    NA,       # CKD-EPI-2021 - Diabetic"
"0","    0.737654  # CKD-EPI-2021 - Hypertensive"
"0","  ),"
"0","  CI_Lower = c("
"0","    0.704901, # MDRD - CKD Very High Risk"
"0","    0.509451, # MDRD - CKD High Risk"
"0","    0.485806, # MDRD - CKD Medium Risk"
"0","    NA,       # MDRD - Diabetic"
"0","    0.403540, # MDRD - Hypertensive"
"0","    0.701012, # CKD-EPI-2009 - CKD Very High Risk"
"0","    0.502408, # CKD-EPI-2009 - CKD High Risk"
"0","    0.349130, # CKD-EPI-2009 - CKD Medium Risk"
"0","    NA,       # CKD-EPI-2009 - Diabetic"
"0","    0.406302, # CKD-EPI-2009 - Hypertensive"
"0","    0.652066, # CKD-EPI-2021 - CKD Very High Risk"
"0","    0.457040, # CKD-EPI-2021 - CKD High Risk"
"0","    0.259102, # CKD-EPI-2021 - CKD Medium Risk"
"0","    NA,       # CKD-EPI-2021 - Diabetic"
"0","    0.406177  # CKD-EPI-2021 - Hypertensive"
"0","  ),"
"0","  CI_Upper = c("
"0","    0.918060, # MDRD - CKD Very High Risk"
"0","    0.967742, # MDRD - CKD High Risk"
"0","    0.929987, # MDRD - CKD Medium Risk"
"0","    NA,       # MDRD - Diabetic"
"0","    1.000000, # MDRD - Hypertensive"
"0","    0.915068, # CKD-EPI-2009 - CKD Very High Risk"
"0","    0.982615, # CKD-EPI-2009 - CKD High Risk"
"0","    0.924220, # CKD-EPI-2009 - CKD Medium Risk"
"0","    NA,       # CKD-EPI-2009 - Diabetic"
"0","    1.000000, # CKD-EPI-2009 - Hypertensive"
"0","    0.897474, # CKD-EPI-2021 - CKD Very High Risk"
"0","    0.977689, # CKD-EPI-2021 - CKD High Risk"
"0","    0.932762, # CKD-EPI-2021 - CKD Medium Risk"
"0","    NA,       # CKD-EPI-2021 - Diabetic"
"0","    1.000000  # CKD-EPI-2021 - Hypertensive"
"0","  )"
"0",")"
"0",""
"0",""
"0",""
"0","# Load necessary libraries"
"0","library(dplyr)"
"0","library(gt)"
"0","library(magick)"
"0","library(webshot2)  # Required to capture HTML as an image"
"0","library(tidyr)     # Needed for replace_na function"
"0",""
"0","# Add formatted columns for display, excluding error bar length"
"0","data_asian_2yr <- data_asian_2yr %>%"
"0","  mutate("
"0","    CI_Label = sprintf(""%.2f (%.2f–%.2f)"", C_Statistic, CI_Lower, CI_Upper)"
"0","  )"
"0",""
"0","data_asian_5yr <- data_asian_5yr %>%"
"0","  mutate("
"0","    CI_Label = sprintf(""%.2f (%.2f–%.2f)"", C_Statistic, CI_Lower, CI_Upper)"
"0","  )"
"0",""
"0","# Replace NA values with empty strings for character columns"
"0","data_asian_2yr <- data_asian_2yr %>% "
"0","  mutate(across(where(is.character), ~replace_na(.x, """")))"
"0",""
"0","data_asian_5yr <- data_asian_5yr %>% "
"0","  mutate(across(where(is.character), ~replace_na(.x, """")))"
"0",""
"0","# Function to generate gt table"
"0","generate_gt_table <- function(data, title) {"
"0","  data %>%"
"0","    group_by(Model) %>%"
"0","    mutate(Model = ifelse(row_number() == 0, Model, """")) %>%"
"0","    ungroup() %>%"
"0","    select(-C_Statistic, -CI_Lower, -CI_Upper) %>%  # Exclude numeric columns not needed in display"
"0","    gt() %>%"
"0","    tab_header(title = md(paste0(""**Predictive Accuracy for Asian Population - "", title, ""**""))) %>%"
"0","    cols_label("
"0","      Population = md(""**Cohort / Population**""),"
"0","      Model = md(""**Prediction Model**""),"
"0","      CI_Label = md(""**C Statistic (95% CI)**"")"
"0","    ) %>%"
"0","    tab_row_group(label = md(""**CKD-EPI-2021**""), rows = 11:15) %>%"
"0","    tab_row_group(label = md(""**CKD-EPI-2009**""), rows = 6:10) %>%"
"0","    tab_row_group(label = md(""**MDRD**""), rows = 1:5) %>%"
"0","    fmt_markdown(columns = c(Population, Model, CI_Label)) %>% # Apply bold markdown styling to data cells"
"0","    tab_options("
"0","      table.font.size = px(40),"
"0","      data_row.padding = px(12),"
"0","      heading.title.font.size = px(50),"
"0","      heading.title.font.weight = ""bold"","
"0","      column_labels.font.size = px(50),"
"0","      column_labels.font.weight = ""bold"""
"0","    )"
"0","}"
"0",""
"0","# Generate the tables for 2-year and 5-year predictions"
"0","table_2yr <- generate_gt_table(data_asian_2yr, ""2-Year Prediction"")"
"0","table_5yr <- generate_gt_table(data_asian_5yr, ""5-Year Prediction"")"
"0",""
"0","# Create HTML files for the gt tables"
"0","gtsave(table_2yr, ""table_2yr.html"")"
"0","gtsave(table_5yr, ""table_5yr.html"")"
"0",""
"0","# Use webshot2 to save HTML as PNG"
"0","webshot(""table_2yr.html"", file = ""table_2yr.png"")"
"2","file:////Users/ndeyisatoujobe/Desktop/SM Thesis/table_2yr.html screenshot completed
"
"0","webshot(""table_5yr.html"", file = ""table_5yr.png"")"
"2","file:////Users/ndeyisatoujobe/Desktop/SM Thesis/table_5yr.html screenshot completed
"
"0","# Read the images and stack them vertically"
"0","img_2yr <- image_read(""table_2yr.png"")"
"0","img_5yr <- image_read(""table_5yr.png"")"
"0","combined_img <- image_append(c(img_2yr, img_5yr), stack = TRUE)"
"0",""
"0","# Save the combined image"
"0","image_write(combined_img, ""asian_combined_prediction_tables.png"")"
"0",""
